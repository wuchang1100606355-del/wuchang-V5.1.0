# 查詢路由器設備列表指南

**目的**：列出路由器上的連接設備（名稱和 IP），以確認伺服器的兩個身份。

---

## 🚀 方法一：使用 Python 腳本（推薦）

### 步驟 1：設定路由器認證

**選項 A：使用環境變數**

```powershell
$env:ROUTER_USERNAME = "admin"
$env:ROUTER_PASSWORD = "your_password"
```

**選項 B：建立 router_config.json**

```json
{
  "username": "admin",
  "password": "your_password"
}
```

### 步驟 2：執行查詢腳本

```powershell
python list_router_devices.py
```

**腳本會顯示**：
- 所有連接設備的名稱和 IP
- 伺服器設備（192.168.50.x 網段）
- 雙身份配置建議

---

## 🚀 方法二：直接在路由器 Web 介面查看

### 步驟 1：登入路由器

**訪問**：https://192.168.50.84:8443

或使用外部 IP：https://220.135.21.74:8443

### 步驟 2：查看設備列表

**路徑**：
- 網路地圖 → 用戶端
- 或 系統管理 → 用戶端清單

**應該看到**：
- 所有連接設備的名稱
- 每個設備的 IP 地址
- MAC 地址

### 步驟 3：識別伺服器設備

**尋找**：
- IP 地址為 `192.168.50.249` 的設備（身份 1）
- IP 地址為 `192.168.50.XXX` 的設備（身份 2，需要確認）
- 兩個設備可能有不同的名稱

---

## 🚀 方法三：使用路由器 API（進階）

### 使用 router_integration.py

```python
from router_integration import RouterIntegration

router = RouterIntegration(
    hostname="192.168.50.84",
    port=8443,
    username="admin",
    password="your_password"
)

router.login()
devices = router.get_connected_devices()

print(f"連接設備總數: {devices['total_count']}")
for device in devices['devices']:
    print(f"名稱: {device.get('name', '未知')}")
    print(f"IP: {device.get('ip', '未知')}")
    print(f"MAC: {device.get('mac', '未知')}")
    print("-" * 40)
```

---

## 📋 需要確認的資訊

### 身份 1（已知部分）
- IP：`192.168.50.249`
- 名稱：需要確認

### 身份 2（待確認）
- IP：需要確認（可能是 `192.168.50.XXX`）
- 名稱：需要確認

---

## 🔍 識別伺服器設備的提示

### 1. 檢查 IP 範圍

伺服器設備應該在 `192.168.50.x` 網段中。

### 2. 檢查設備名稱

伺服器設備可能的名稱：
- 包含 "server"、"伺服器"
- 包含主機名稱
- 可能是 Docker 主機名稱

### 3. 檢查 MAC 地址

如果有兩個設備有相似的 MAC 地址（可能是同一台機器的兩個網卡）。

---

## 📝 記錄設備資訊

**找到設備後，請記錄**：

```
身份 1：
  名稱: ___________
  IP: 192.168.50.249
  MAC: ___________

身份 2：
  名稱: ___________
  IP: ___________
  MAC: ___________
```

---

## 🚀 下一步

**取得設備列表後**：
1. 確認兩個身份的名稱和 IP
2. 確認每個服務使用哪個身份
3. 更新 `cloudflared/config.yml`
4. 部署並驗證

---

**建立時間**：2026-01-22
