# Cloudflare Tunnel 雙身份配置確認

**更新時間**：2026-01-22

---

## 📋 雙身份資訊

### 身份 1（有線網卡）
- **名稱**：server
- **IP**：`192.168.50.249`（IPv4）
- **IPv6**：`fe80::9449:739a:4999:f566`
- **MAC**：`30:9C:23:4A:9B:1B`
- **類型**：有線網卡
- **介面**：有線連接

### 身份 2（WiFi 網卡）
- **名稱**：svrver 2（路由器顯示，可能是 server 2 的拼寫變體）
- **IP**：需要確認 IPv4（目前只顯示 IPv6）
- **IPv6**：`fe80::cdf9:2266:dc55:bcc6`
- **MAC**：`1C:3E:84:67:C0:16`
- **類型**：WiFi 網卡
- **介面**：work_IoT (5G Wi-Fi)

---

## 🔍 需要確認的資訊

### 1. 身份 2 的 IP 地址

**在伺服器上執行**：

```bash
# 查看所有網卡和 IP
ip addr show

# 或
ifconfig

# 尋找 "Wistron Neweb Corporation 2" 網卡的 IP
```

### 2. 服務分配

**確認每個服務使用哪個身份**：

| 服務 | 身份 | IP | 端口 |
|------|------|-----|------|
| wuchang.life | 身份 1/身份 2 | ? | 80 |
| app.wuchang.org.tw | 身份 1/身份 2 | ? | 8069 |
| ai.wuchang.org.tw | 身份 1/身份 2 | ? | 8080 |
| admin.wuchang.org.tw | 身份 1/身份 2 | ? | 9000 |
| monitor.wuchang.org.tw | 身份 1/身份 2 | ? | 3001 |

---

## 🚀 配置選項

### 選項 A：所有服務使用身份 1（當前配置）

如果所有服務都使用有線網卡（身份 1），當前配置已正確：

```yaml
ingress:
  - hostname: wuchang.life
    service: http://192.168.50.249:80  # 身份 1
```

### 選項 B：服務分散到兩個身份

如果不同服務使用不同網卡：

```yaml
ingress:
  # 身份 1 的服務（有線網卡）
  - hostname: wuchang.life
    service: http://192.168.50.249:80
  
  # 身份 2 的服務（WiFi 網卡）
  - hostname: app.wuchang.org.tw
    service: http://192.168.50.XXX:8069  # 身份 2 IP
```

### 選項 C：容錯配置

使用兩個身份作為主備：

```yaml
ingress:
  # 主要路徑（身份 1）
  - hostname: wuchang.life
    service: http://192.168.50.249:80
  
  # 備援路徑（身份 2）
  - hostname: wuchang.life
    service: http://192.168.50.XXX:80
    originRequest:
      failoverTimeout: 10s
```

---

## 📝 下一步

1. **確認身份 2 的 IP**：在伺服器上查看 WiFi 網卡的 IP
2. **確認服務分配**：每個服務使用哪個身份
3. **更新 config.yml**：根據實際情況調整
4. **部署並驗證**

---

**建立時間**：2026-01-22
