# 小 J 全局浮動圖示使用指南

## 概述

小 J 服務現在以透明圓形圖示的形式顯示在所有系統的最上層，方便隨時查看狀態和快速操作。

## 功能特性

### 視覺設計
- ✅ **透明圓形設計**: 使用毛玻璃效果（backdrop-filter）
- ✅ **漸變背景**: 紫色漸變，與系統主題一致
- ✅ **浮動動畫**: 輕微的上下浮動效果
- ✅ **狀態指示器**: 右上角彩色圓點顯示運行狀態
- ✅ **響應式設計**: 適配所有設備尺寸

### 交互功能
- ✅ **點擊展開**: 點擊圖示顯示詳細信息
- ✅ **拖動移動**: 可以拖動到任意位置
- ✅ **位置記憶**: 自動保存位置到 localStorage
- ✅ **工具提示**: 懸停顯示詳細狀態

### 狀態顯示
- ✅ **運行狀態**: 正常/待機/錯誤
- ✅ **執行次數**: 顯示 AI 程序執行次數
- ✅ **最後活動**: 顯示最後執行時間
- ✅ **實時更新**: 每 5 秒自動更新狀態

## 位置和樣式

### 默認位置
- **桌面端**: 右下角，距離邊緣 30px
- **平板端**: 右下角，距離邊緣 20px
- **手機端**: 右下角，距離邊緣 15px

### 尺寸
- **桌面端**: 70x70px
- **平板端**: 60x60px
- **手機端**: 55x55px

### 層級
- **z-index**: 999999（最高層級，確保在所有內容之上）

## 狀態顏色

- 🟢 **綠色**: 正常運行
- 🟡 **黃色**: 待機狀態
- 🔴 **紅色**: 錯誤狀態

## 使用方式

### 查看狀態
1. **懸停**: 將鼠標懸停在圖示上，顯示工具提示
2. **點擊**: 點擊圖示展開/收起工具提示

### 移動位置
1. **拖動**: 按住圖示並拖動到任意位置
2. **自動保存**: 位置會自動保存，刷新後保持

### 快速操作
- **打開面板**: 點擊工具提示中的「打開面板」按鈕
- **執行任務**: 點擊工具提示中的「執行任務」按鈕

## 技術實現

### HTML 結構
```html
<div id="littleJIcon" class="little-j-icon">
    <div class="little-j-circle">
        <div class="little-j-content">
            <div class="little-j-avatar">🤖</div>
            <div class="little-j-status">
                <div class="status-dot"></div>
            </div>
        </div>
    </div>
    <div class="little-j-tooltip">
        <!-- 工具提示內容 -->
    </div>
</div>
```

### CSS 特性
- **毛玻璃效果**: `backdrop-filter: blur(10px)`
- **漸變背景**: `linear-gradient(135deg, ...)`
- **陰影效果**: 多層陰影營造浮動感
- **動畫效果**: CSS 動畫實現浮動和脈衝

### JavaScript 功能
- **狀態更新**: 定期從 API 獲取狀態
- **拖動功能**: 支持鼠標和觸摸拖動
- **位置保存**: 使用 localStorage 保存位置
- **事件監聽**: 監聽全局狀態更新事件

## 自定義配置

### 修改位置
在 `little_j_floating_icon.py` 中修改：
```css
.little-j-icon {
    bottom: 30px;  /* 距離底部 */
    right: 30px;  /* 距離右側 */
}
```

### 修改大小
```css
.little-j-circle {
    width: 70px;   /* 寬度 */
    height: 70px;  /* 高度 */
}
```

### 修改顏色
```css
.little-j-circle {
    background: linear-gradient(135deg, 
        rgba(102, 126, 234, 0.9) 0%, 
        rgba(118, 75, 162, 0.9) 100%);
}
```

## 整合狀態

✅ **已整合到 web_ui.py**
✅ **自動在所有頁面顯示**
✅ **響應式設計**
✅ **實時狀態更新**

## 注意事項

1. **層級問題**: 如果其他元素也有高 z-index，可能需要調整
2. **性能**: 定期更新狀態，但頻率已優化（5秒）
3. **兼容性**: 使用現代 CSS 特性，需要支持 backdrop-filter 的瀏覽器
4. **觸摸設備**: 支持觸摸拖動，適配移動設備

## 故障排除

### 圖示不顯示
1. 檢查 `little_j_floating_icon.py` 是否正確導入
2. 檢查瀏覽器控制台是否有錯誤
3. 確認 z-index 是否被其他元素覆蓋

### 無法拖動
1. 檢查 JavaScript 是否正確加載
2. 檢查是否有其他事件監聽器衝突
3. 確認觸摸事件是否被阻止

### 狀態不更新
1. 檢查 API 端點 `/api/ai/settings` 是否正常
2. 檢查網絡連接
3. 查看瀏覽器控制台錯誤信息
